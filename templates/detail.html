<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }} | Sh's Blog</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Highlight.js -->
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'css/modern-style.css' %}">
</head>
<body>
    <!-- Animated Background -->
    <div class="animated-bg"></div>

    <!-- Floating Navbar -->
    <nav class="floating-nav">
        <div class="container">
            <a href="/" class="brand">Sh'süéÄN's</a>
            <div class="nav-links">
                <a href="{% url 'blog:home' %}"><i class="fas fa-home"></i> Home</a>
                <a href="{% url 'blog:contact' %}" class="active"><i class="fas fa-envelope"></i> Contact</a>
                <a href="{% url 'blog:about' %}" class="active"><i class="fas fa-envelope"></i> About</a>
                 {% if request.user.is_authenticated %}
                    <a href="{% url 'blog:profile' %}">üéÄ Profile</a>
                {% else %}
                    <a href="{% url 'login' %}">üîê Login</a>
                    <a href="{% url 'signup' %}">üìù Sign Up</a>
                {% endif %}
                <div class="search-box">
                    <form action="{% url 'blog:search' %}" method="get">
                        <input type="text" name="query" placeholder="Search...">
                        <button type="submit"><i class="fas fa-search"></i></button>
                    </form>
                </div>
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container detail-page">
        <article class="post-detail">
            <!-- Post Header -->
            <header class="post-header">
                <div class="post-meta">
                    <span class="date"><i class="far fa-calendar"></i> {{ post.created_at|date:"M d, Y" }}</span>
                    <span class="views"><i class="far fa-eye"></i> {{ post.views }}</span>
                    <span class="comments"><i class="far fa-comment"></i> {{ post.comments.all.count }}</span>
                </div>
                <h1 class="post-title">{{ post.title }}</h1>
                <div class="post-tags">
                    {% for tag in post.tag.all %}
                    <span class="tag">{{ tag.name }}</span>
                    {% endfor %}
                </div>
            </header>

            <!-- Post Content -->
            <div class="post-content">
                {{ post.body|safe }}
            </div>

            <!-- Post Rating -->
            <div class="post-rating">
                <h4>Rate this post:</h4>
                <div class="stars" data-post-id="{{ post.id }}">
                    {% for i in "12345" %}
                    <i class="far fa-star" data-rating="{{ forloop.counter }}"></i>
                    {% endfor %}
                    <span class="rating-text">Average: {{ post.get_avg_rating|floatformat:1 }}/5 ({{ post.ratings.all.count }} votes)</span>
                </div>
            </div>

            <!-- Comments Section -->
            <div class="comments-section">
                <h3><i class="far fa-comments"></i> Comments ({{ post.comments.all.count }})</h3>

                {% for comment in post.comments.all %}
                <div class="comment">
                    <div class="comment-header">
                        <div class="comment-author">{{ comment.author }}</div>
                        <div class="comment-date">{{ comment.created_at|date:"M d, Y" }}</div>
                    </div>
                    <div class="comment-body">
                        {{ comment.comment }}
                    </div>
                </div>
                {% empty %}
                <div class="no-comments">
                    <i class="far fa-comment-slash"></i>
                    <p>No comments yet. Be the first to comment!</p>
                </div>
                {% endfor %}

                <!-- Comment Form -->
                <div class="comment-form">
                    <h4>Leave a Comment</h4>
                    <form method="post" action="#">
                        {% csrf_token %}
                        <div class="form-group">
                            <input type="text" name="name" placeholder="Your Name" required>
                        </div>
                        <div class="form-group">
                            <textarea name="comment" placeholder="Your Comment" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="btn-submit">Post Comment</button>
                    </form>
                </div>
            </div>
        </article>

        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Related Posts -->
            <div class="sidebar-widget">
                <h3 class="widget-title">Related Posts</h3>
                <div class="related-posts">
                    {% for related_post in related_posts %}
                    <a href="{% url 'blog:detail' related_post.id %}" class="related-post">
                        <div class="related-post-content">
                            <h4>{{ related_post.title|truncatewords:6 }}</h4>
                            <div class="post-meta">
                                <span><i class="far fa-eye"></i> {{ related_post.views }}</span>
                                <span><i class="far fa-comment"></i> {{ related_post.comments.all.count }}</span>
                            </div>
                        </div>
                    </a>
                    {% empty %}
                    <div class="no-related">
                        No related posts found
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Newsletter -->
            <div class="sidebar-widget newsletter">
                <h3 class="widget-title">Newsletter</h3>
                <p>Subscribe to get the latest posts delivered to your inbox</p>
                <form class="newsletter-form">
                    <input type="email" placeholder="Your Email">
                    <button type="submit">Subscribe</button>
                </form>
            </div>
        </aside>
    </main>

    <!-- Footer -->
    <footer class="modern-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>Sh's Blog</h3>
                    <p>Modern, clean and responsive blog template</p>
                </div>
                <div class="footer-links">
                    <a href="{% url 'blog:home' %}">Home</a>
                    <a href="{% url 'blog:contact' %}">Contact</a>
                    <a href="#">About</a>
                </div>
                <div class="social-links">
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-github"></i></a>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2023 Sh's Blog. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Back to Top Button -->
    <button id="backToTop" class="back-to-top">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="{% static 'js/modern-blog.js' %}"></script>
    <script>
        // Highlight code blocks
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre code').forEach((el) => {
                hljs.highlightElement(el);
            });
        });
    </script>
</body>
</html>
